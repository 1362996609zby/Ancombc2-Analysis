# Ancombc2-Analysis
用于ANCOMBC2分析的脚本，可直接使用
# OTU_Table 示例格式
# OTU_Table 数据应该是一个包含 OTU ID 和样本丰度的矩阵，第一列是 OTU ID，第一行是样本名，剩余部分是丰度值。
# 示例：
# | OTU ID  | Sample1 | Sample2 | Sample3 |
# |---------|---------|---------|---------|
# | OTU1    |    5    |    8    |    0    |
# | OTU2    |    3    |    1    |    4    |
# | OTU3    |    0    |    2    |    7    |

# Metadata 示例格式
# Metadata 数据应包含每个样本的元数据信息，例如分组信息、协变量或随机因素。
# 示例：
# | SampleID | Group  | Age | Gender | Batch |
# |----------|--------|-----|--------|-------|
# | Sample1  | Group1 |  25 |   M    |   1   |
# | Sample2  | Group2 |  30 |   F    |   1   |
# | Sample3  | Group1 |  28 |   M    |   2   |

# 在不同参数选择下：
# 1. **两组比较，无协变量或随机因素**：只需包含 'SampleID' 和 'Group' 列。
# 2. **多组比较，包含协变量**：除了 'SampleID' 和 'Group'，还需要包含协变量列，例如 'Age'、'Gender'。
# 3. **包含随机因素**：需要包含 'SampleID'、'Group' 以及随机因素列，例如 'Batch'，表示实验批次或其他随机效应。

# 结果说明
# ANCOM-BC2 结果数据包含以下列：
# - **taxon**: 微生物分类单元 (例如物种或属)。
# - **lfc_(Intercept)** 和 **lfc_Group**: 每个分类单元的对数折叠变化 (log fold change)。
#   - `(Intercept)`: 代表基线组的对数折叠变化，表示在所有条件相同的情况下，微生物的基础丰度，可以理解为是对照组丰度。
#   - `Group`: 代表不同实验组与基线组之间的差异，表示某组与基线组相比的对数折叠变化。例如，`lfc_GroupRHCA` 表示 `GroupRHCA` 与基线组之间的差异。
#   - 实际生物学意义：
#     - 截距 (`(Intercept)`) 表示基线条件下的微生物丰度。基线条件是指没有受到任何处理或默认实验条件下的状态，它代表了在这种默认条件下微生物的自然丰度水平。这可以作为比较的基准，用于评估不同处理组如何改变微生物丰度。
#     - `group` 列则反映不同实验处理组与基线之间的相对丰度变化。显著的对数折叠变化意味着该组中的微生物丰度显著高于或低于基线组。
# - **se_(Intercept)** 和 **se_Group**: 对应的标准误差，表示估计的精度。
# - **W_(Intercept)** 和 **W_Group**: 统计量，等于 lfc / se，用于判断丰度是否显著不同于零。
# - **p_(Intercept)** 和 **p_Group**: p 值，基于双侧 Z 检验，用于检验丰度是否显著不同于零。
# - **q_(Intercept)** 和 **q_Group**: 调整后的 p 值，使用指定的多重比较校正方法。用于控制假阳性率。
# - **diff_(Intercept)** 和 **diff_Group**: 布尔值，指示该分类单元在该组是否显著 (TRUE 表示显著)。
# - **passed_ss_(Intercept)** 和 **passed_ss_Group**: 布尔值，指示该分类单元在灵敏度分析中是否通过。
#
# 生物学意义：
# - **基线组的丰度是否显著不同于零**：
#   - 如果基线组的丰度显著不同于零，表示该微生物在基线条件下普遍存在且具有重要的生态角色，能够作为对比参考点。
#   - 如果不显著不同于零，则该微生物在基线条件下稀少，可能对生态系统的影响有限，因此对其他组的比较意义也较弱。
# - **实验组与基线组的比较**：
#   - 通过比较实验组与基线组的对数折叠变化，可以评估实验处理是否对微生物的丰度产生显著影响，从而揭示不同条件下微生物群落结构的变化。
#
# 使用这些结果，您可以确定哪些微生物在不同分组之间表现出显著的丰度差异。对于多组比较，`res_pair` 将包含每组之间的对比结果。
